(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-de1866dc"],{3593:function(e,t,n){"use strict";n.r(t),n.d(t,"getList",(function(){return o})),n.d(t,"createItem",(function(){return a}));var r=n("b775");function o(){return Object(r["default"])({url:"/barberitem/list",method:"get"})}function a(e){return Object(r["default"])({url:"/barberitem/",method:"post",data:e})}},"6a85":function(e,t,n){"use strict";n.r(t);n("b0c0");var r=n("f2bf"),o=Object(r["l"])("选择用户"),a=Object(r["l"])("提交"),u=Object(r["l"])("重置");function c(e,t,n,c,d,l){var i=Object(r["K"])("a-tag"),s=Object(r["K"])("a-button"),f=Object(r["K"])("user-select-modal"),m=Object(r["K"])("a-form-item"),b=Object(r["K"])("a-textarea"),O=Object(r["K"])("a-input-number"),j=Object(r["K"])("a-table"),h=Object(r["K"])("a-transfer"),g=Object(r["K"])("a-form");return Object(r["C"])(),Object(r["j"])(g,null,{default:Object(r["V"])((function(){return[Object(r["m"])(m,{label:"选择用户"},{default:Object(r["V"])((function(){return[d.selectedUserName?(Object(r["C"])(),Object(r["j"])(i,{key:0},{default:Object(r["V"])((function(){return[Object(r["l"])(" 【"+Object(r["N"])(d.form.userid)+"】"+Object(r["N"])(d.selectedUserName),1)]})),_:1})):Object(r["k"])("",!0),Object(r["m"])(s,{onClick:t[1]||(t[1]=function(e){return d.selectUserModal=!0})},{default:Object(r["V"])((function(){return[o]})),_:1}),Object(r["m"])(f,{showModal:d.selectUserModal,"onUpdate:showModal":t[2]||(t[2]=function(e){return d.selectUserModal=e}),onUserSelected:l.onUserSelect},null,8,["showModal","onUserSelected"])]})),_:1}),Object(r["m"])(m,{label:"备注"},{default:Object(r["V"])((function(){return[Object(r["m"])(b,{value:d.form.remark,"onUpdate:value":t[3]||(t[3]=function(e){return d.form.remark=e}),showCount:"",allowClear:"",size:"small",maxlength:255,cols:100,"auto-size":{minRows:1,maxRows:4}},null,8,["value"])]})),_:1}),Object(r["m"])(m,{label:"添加项目"},{default:Object(r["V"])((function(){return[Object(r["m"])(h,{"data-source":d.transfer.data,"show-search":"","show-select-all":!1,"target-keys":d.transfer.targetKeys,"row-key":function(e){return e.itemid},render:function(e){return e.name},style:{width:"800px"},"filter-option":function(e,t){return-1!==t.name.indexOf(e)||t.itemid==e},onChange:t[4]||(t[4]=function(e){d.transfer.targetKeys=e})},{children:Object(r["V"])((function(e){var t=e.direction,n=e.filteredItems,o=e.selectedKeys,a=e.onItemSelect;return[Object(r["m"])(j,{columns:"left"===t?d.transfer.table.leftColumns:d.transfer.table.rightColumns,"row-selection":{selectedRowKeys:o,onSelect:function(e,t){var n=e.key;a(n,t)}},"row-key":"itemid","data-source":n,size:"small"},{amount:Object(r["V"])((function(e){var t=e.record;return[Object(r["m"])(O,{value:t.amount,"onUpdate:value":function(e){return t.amount=e},min:1,max:99,defaultValue:1},null,8,["value","onUpdate:value"])]})),_:2},1032,["columns","row-selection","data-source"])]})),_:1},8,["data-source","target-keys","row-key","render","filter-option"])]})),_:1}),Object(r["m"])(m,null,{default:Object(r["V"])((function(){return[Object(r["m"])(s,{type:"primary",onClick:l.onSubmit},{default:Object(r["V"])((function(){return[a]})),_:1},8,["onClick"]),Object(r["m"])(s,{style:{"margin-left":"10px"},onClick:l.onReset},{default:Object(r["V"])((function(){return[u]})),_:1},8,["onClick"])]})),_:1})]})),_:1})}n("159b");var d=n("8879"),l=n("ed3b"),i=n("3593"),s=n("f8b7"),f={components:{userSelectModal:d["default"]},methods:{onUserSelect:function(e){this.selectedUserName=e.username,this.form.userid=e.userid},onReset:function(){},onSubmit:function(){var e=this;console.log(this.transfer.targetKeys),console.log(this.transfer.data),Object(s["createOrder"])({sponsorid:1,ownerid:this.form.userid,remark:this.form.remark}).then((function(){e.transfer.targetKeys.forEach((function(t){Object(s["getLastOrder"])().then((function(n){Object(s["addItem"])(n.data.oid,{itemid:t,sponsorid:1,ownerid:e.form.userid,amount:5})}))})),l["a"].success({title:"创建成功!"})}))},onChange:function(e){console.log(e),this.transfer.targetKeys=e}},mounted:function(){var e=this;Object(i["getList"])().then((function(t){e.transfer.data=t.data}))},data:function(){return{selectUserModal:!1,selectedUserName:"",form:{userid:null,remark:""},transfer:{data:[],targetKeys:[],table:{leftColumns:[{dataIndex:"itemid",title:"ID"},{dataIndex:"name",title:"名称"},{dataIndex:"price",title:"价格"},{dataIndex:"remark",title:"描述"}],rightColumns:[{dataIndex:"itemid",title:"ID"},{dataIndex:"name",title:"名称"},{dataIndex:"price",title:"价格"},{dataIndex:"amount",title:"数量",slots:{customRender:"amount"}}]}}}}};f.render=c;t["default"]=f},8879:function(e,t,n){"use strict";n.r(t);var r=n("f2bf");function o(e,t,n,o,a,u){var c=Object(r["K"])("a-table"),d=Object(r["K"])("a-modal");return Object(r["C"])(),Object(r["j"])(d,{visible:n.showModal,onCancel:u.onModalClose,title:"选择用户",onOk:u.onUserSelect,footer:null},{default:Object(r["V"])((function(){return[Object(r["m"])(c,{columns:a.modal.columns,"data-source":a.modal.data,bordered:"",size:"small",loading:a.modal.loading},{username:Object(r["V"])((function(e){var t=e.record,n=e.text;return[Object(r["m"])("a",{onClick:function(e){return u.onUserSelect(t)}},Object(r["N"])(n),9,["onClick"])]})),_:1},8,["columns","data-source","loading"])]})),_:1},8,["visible","onCancel","onOk"])}var a=n("c24f"),u={methods:{onUserSelect:function(e){this.$emit("userSelected",e),this.onModalClose()},onModalClose:function(){this.$emit("update:showModal",!1)}},mounted:function(){var e=this;this.modal.loading=!0,Object(a["getList"])().then((function(t){e.modal.data=t.data,e.modal.loading=!1}))},data:function(){return{modal:{loading:!0,data:[],columns:c}}},props:["showModal"]},c=[{title:"会员号",dataIndex:"userid",key:"userid",sorter:function(e,t){return e.userid-t.userid},sortDirections:["descend","ascend"]},{title:"用户姓名",dataIndex:"username",key:"username",slots:{customRender:"username"}},{title:"余额",key:"balance",dataIndex:"balance",sorter:function(e,t){return e.balance-t.balance},sortDirections:["descend","ascend"]}];u.render=o;t["default"]=u},c24f:function(e,t,n){"use strict";n.r(t),n.d(t,"getList",(function(){return o})),n.d(t,"getStoredValueLogs",(function(){return a})),n.d(t,"register",(function(){return u})),n.d(t,"verifyPasswd",(function(){return c}));var r=n("b775");function o(){return Object(r["default"])({url:"/user/list",method:"get"})}function a(){return Object(r["default"])({url:"/storedvalue/log/list",method:"get"})}function u(e){return Object(r["default"])({url:"/user/register",method:"post",data:e})}function c(e){return Object(r["default"])({url:"/user/id/"+e.uid+"/passwd/verify",method:"post",data:{passwd:e.passwd}})}},f8b7:function(e,t,n){"use strict";n.r(t),n.d(t,"getList",(function(){return o})),n.d(t,"createOrder",(function(){return a})),n.d(t,"getListByUID",(function(){return u})),n.d(t,"getOrderByID",(function(){return c})),n.d(t,"addItem",(function(){return d})),n.d(t,"deleteItem",(function(){return l})),n.d(t,"updateItemAmount",(function(){return i})),n.d(t,"getLastOrder",(function(){return s}));var r=n("b775");function o(){return Object(r["default"])({url:"/order/list",method:"get"})}function a(e){return Object(r["default"])({url:"/order/create",method:"post",params:e})}function u(e){return Object(r["default"])({url:"/order/list/uid/"+e,method:"get"})}function c(e){return Object(r["default"])({url:"/order/id/"+e,method:"get"})}function d(e,t){return Object(r["default"])({url:"/order/id/"+e+"/item",method:"post",params:t})}function l(e,t){return Object(r["default"])({url:"/order/id/"+e+"/item",method:"delete",params:t})}function i(e,t,n){return Object(r["default"])({url:"/order/id/"+e+"/item/"+t,method:"put",params:n})}function s(){return Object(r["default"])({url:"/order/lastorder",method:"get"})}}}]);